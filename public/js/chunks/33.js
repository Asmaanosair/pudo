(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{531:function(t,e,r){"use strict";r.r(e);var o=r(3),a=r(491),i=r(492),n=r(493),s=r(496),l=r(497),d=r(498),c=r(495),p=r(494),u=r(499),m=r(500),v=r(501),A=r(502),g=r(2),f=r.n(g);function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var y=[{name:"OpenStreetMap",visible:!0,attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}],_={name:"Example",components:{LMap:a.a,LTileLayer:i.a,LMarker:n.a,LIcon:s.a,LPolyline:l.a,LLayerGroup:d.a,LTooltip:c.a,LPopup:p.a,LControlZoom:u.a,LControlAttribution:m.a,LControlScale:v.a,LControlLayers:A.a},data:function(){return{sideStyle:{position:"fixed",overflowY:"scroll",top:0,bottom:0},fleets:[],orders:[],sideShow:!0,activeBtnMap:!0,center:[41.0140076,28.6829777],opacity:.6,token:"your token if using mapbox",mapOptions:{zoomControl:!1,attributionControl:!1,zoomSnap:!0},zoom:3,minZoom:1,maxZoom:15,zoomPosition:"topleft",attributionPosition:"bottomright",layersPosition:"topleft",attributionPrefix:"Vue2Leaflet",imperial:!1,Positions:["topleft","topright","bottomleft","bottomright"],tileProviders:y,iconSize:35,markers:[],bounds:Object(o.latLngBounds)({lat:25.025965,lng:47.275023},{lat:24.592777,lng:46.359089})}},computed:{dynamicSize:function(){return[this.iconSize,1.15*this.iconSize]},dynamicAnchor:function(){return[this.iconSize/2,1.15*this.iconSize]}},mounted:function(){this.getInfo()},methods:{handleSideOrder:function(){alert("clicked"),document.getElementById("my-side-order").classList.toggle("handle-order")},fullMap:function(){var t=document.getElementById("mapping");document.getElementById("my-footer").style.display="none",this.activeBtnMap=!1,t.style.position="absolute",t.classList.add("full-map")},defaultMap:function(){var t=document.getElementById("mapping");this.activeBtnMap=!0,document.getElementById("my-footer").style.display="flex",t.style.position="relative",t.classList.remove("full-map")},showOrder:function(t){console.log(t)},getInfo:function(){var t=this;f.a.get("/api/map-data?token="+localStorage.getItem("api_token")).then((function(e){var r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(Object(r),!0).forEach((function(e){h(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e.data);console.log(r),t.orders=e.data.orders,t.markers=[],r.orders.map((function(e){var r={id:"delivery"+e.id,orderId:e.id,position:{lat:parseFloat(e.delivery_lat),lng:parseFloat(e.delivery_lng)},tooltip:"Delivery point order Id: "+e.id+" Code: "+e.code,draggable:!1,visible:!0,markerIcon:"markers/delivery.png",travel:[[e.pick_up_lat,e.pick_up_lng],[e.delivery_lat,e.delivery_lng]],travelId:"td"+e.id};t.markers.push(r);var o={id:"pickup"+e.id,orderId:e.id,position:{lat:parseFloat(e.pick_up_lat),lng:parseFloat(e.pick_up_lng)},tooltip:"PickUp point order Id: "+e.id+" Code: "+e.code,draggable:!1,visible:!0,markerIcon:"markers/pickup.png",travel:[[e.pick_up_lat,e.pick_up_lng],[e.delivery_lat,e.delivery_lng]],travelId:"tp"+e.id};t.markers.push(o)})),console.log(t.markers)})).catch((function(t){console.log(t)}))},focusOnDriver:function(t,e){this.bounds=Object(o.latLngBounds)({lat:t,lng:e},{lat:t,lng:e})}},created:function(){var t=this;t.fleets=[],this.$pusher.subscribe("fleet-location"),this.$pusher.bind("App\\Events\\LocationNow",(function(e){console.log("the location is here");var r={id:"driver"+e.data.user.id,fleetId:e.data.user.id,position:{lat:parseFloat(e.data.lat),lng:parseFloat(e.data.lng)},tooltip:e.data.user.name,draggable:!1,visible:!0,markerIcon:"markers/car.png"},o=t.markers.find((function(t){return t.fleetId===r.fleetId})),a=t.markers.indexOf(o);if(-1!==a)t.markers[a].lat=r.position.lat,t.markers[a].lng=r.position.lng;else{t.markers.push(r);var i=t.fleets.find((function(t){return t.id===e.data.user.id}));console.log(i),i||t.fleets.push(e.data)}})),this.$pusher.bind("App\\Events\\OrderOperation",(function(e){console.log("the order is here"),console.log(e);var r=t.orders.find((function(t){return t.id===e.order.id})),o=t.orders.indexOf(r),a=[8,9,10,11];if(r&&!a.includes(e.order.status.id))Object.keys(r).map((function(r){t.orders[o][r]=e.order[r]}));else if(r&&a.includes(e.order.status.id))t.orders.splice(o,1);else{var i={id:"delivery"+e.order.id,orderId:e.order.id,position:{lat:parseFloat(e.order.delivery_lat),lng:parseFloat(e.order.delivery_lng)},tooltip:"Delivery point order Id: "+e.order.id+" Code: "+e.order.code,draggable:!1,visible:!0,markerIcon:"markers/delivery.png",travel:[[e.order.pick_up_lat,e.order.pick_up_lng],[e.order.delivery_lat,e.order.delivery_lng]],travelId:"td"+r.id};t.markers.push(i);var n={id:"pickup"+e.order.id,orderId:e.order.id,position:{lat:parseFloat(e.order.pick_up_lat),lng:parseFloat(e.order.pick_up_lng)},tooltip:"PickUp point order Id: "+r.id+" Code: "+r.code,draggable:!1,visible:!0,markerIcon:"markers/pickup.png",travel:[[e.order.pick_up_lat,e.order.pick_up_lng],[e.order.delivery_lat,e.order.delivery_lng]],travelId:"tp"+e.order.id};t.markers.push(n),t.orders.push(e.order)}}))}},k=r(1),O=Object(k.a)(_,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("CRow",{staticStyle:{height:"101vh !important","padding-top":"0!important"}},[r("l-map",{ref:"themap",staticStyle:{height:"700px",width:"100%"},attrs:{id:"mapping",zoom:t.zoom,options:t.mapOptions,center:t.center,bounds:t.bounds,"min-zoom":t.minZoom,"max-zoom":t.maxZoom},on:{"update:zoom":function(e){t.zoom=e}}},[t.activeBtnMap?r("img",{staticClass:"full-map-btn",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAZlBMVEX///8AAAClpaVRUVGbm5s4ODjb29vGxsZpaWnDw8Pe3t5/f3+zs7OSkpLY2Ni4uLhxcXEvLy/09PTMzMysrKwNDQ0XFxdbW1tBQUGGhoaYmJjn5+fv7+8eHh55eXlLS0spKSljY2OxaxcIAAACy0lEQVR4nO3dgU4aURSEYbeCAq4giMVWUXz/l2xIa4JLEzlnZ+dyyf89wJwzWUQ2uSxXVwAAAAAAAAAAoH5N0uQxObC9zo40N2ya8SwxbvqUH2hv2DTT8LT7PuMKNGzmwWHrXtNKNNzGZr30GlakYbMOzXqrsOG7cVaZhqGpN1U2XAVGPdLwLBtGRs1qbHhtnFWm4SI061d9DYP/8V/raxj91NbW1jD2Gt0bVdVwe5MYd1tPw0n8Av61mGRvEWUNk0FqNPQHqdHQH6RGQ3+QGg39QWo09Aep0dAfpEZDf5AaDf1BajT0B6nR0B+kRkN/kBoN/UFqNPQHqdHQH6RGQ3+QGg39QWo09Aep0dAfpCZb7OhgxJN0zzxZw4duzoN0zzzZYtNu0K10zzzdYsuvOWPllr3IFuucvs58EWYYc9liX14O5/Ia3VvIFpvvPmN2mcN4w5lvPxdb9l2s3exjNtnDeMNp33WLrSKn7p1Wr6U3AAAAAAAAAAAAAAAAAAAAwAV6HL3djaJPlHUQLbb+98WZn7HH5A9PtdjBj4ZsNJuJqBZ7Pjz0H3tA97BUi3Uesv1bt2FPqsWOflXjXI7GyxY7+uWXkXTPPNliy27Qufwlyhbr5lzed0hpWAwN/UFqNPQHqdHQH6RGQ3+QGg39QWo09Aep0dAfpEZDf5AaDf1BajT0B6nR0B+kRkN/kBoN/UFqNPQHqdHQH6RGQ3+QGg39QWoDNlz/OEGbfyTsrD1lwHrAhida5p4KOx2nJ7ob5h4//dFjnr9h4gzP8/ehZ9WwuQ8Ou+s1rUTD4Gm6Wb9hRRrGLmK/S1imYexB6f1mlWkYmrqqsmHkGdlHZ2KraBgZVeU13Bln8V46TMOX0KwK/x9e/Gea+OfS/I1FkYaTxLhNRQ3H09S8dvt9tLbh6JQb7v/c48feYw6ddo9/7Fy+6gIAAAAAAABcsj/9Uihp19PW+QAAAABJRU5ErkJggg=="},on:{click:function(e){return t.fullMap()}}}):r("img",{staticClass:"default-map-btn",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAZlBMVEX///8AAAClpaVRUVGbm5s4ODjb29vGxsZpaWnDw8Pe3t5/f3+zs7OSkpLY2Ni4uLhxcXEvLy/09PTMzMysrKwNDQ0XFxdbW1tBQUGGhoaYmJjn5+fv7+8eHh55eXlLS0spKSljY2OxaxcIAAACy0lEQVR4nO3dgU4aURSEYbeCAq4giMVWUXz/l2xIa4JLEzlnZ+dyyf89wJwzWUQ2uSxXVwAAAAAAAAAAoH5N0uQxObC9zo40N2ya8SwxbvqUH2hv2DTT8LT7PuMKNGzmwWHrXtNKNNzGZr30GlakYbMOzXqrsOG7cVaZhqGpN1U2XAVGPdLwLBtGRs1qbHhtnFWm4SI061d9DYP/8V/raxj91NbW1jD2Gt0bVdVwe5MYd1tPw0n8Av61mGRvEWUNk0FqNPQHqdHQH6RGQ3+QGg39QWo09Aep0dAfpEZDf5AaDf1BajT0B6nR0B+kRkN/kBoN/UFqNPQHqdHQH6RGQ3+QGg39QWo09Aep0dAfpCZb7OhgxJN0zzxZw4duzoN0zzzZYtNu0K10zzzdYsuvOWPllr3IFuucvs58EWYYc9liX14O5/Ia3VvIFpvvPmN2mcN4w5lvPxdb9l2s3exjNtnDeMNp33WLrSKn7p1Wr6U3AAAAAAAAAAAAAAAAAAAAwAV6HL3djaJPlHUQLbb+98WZn7HH5A9PtdjBj4ZsNJuJqBZ7Pjz0H3tA97BUi3Uesv1bt2FPqsWOflXjXI7GyxY7+uWXkXTPPNliy27Qufwlyhbr5lzed0hpWAwN/UFqNPQHqdHQH6RGQ3+QGg39QWo09Aep0dAfpEZDf5AaDf1BajT0B6nR0B+kRkN/kBoN/UFqNPQHqdHQH6RGQ3+QGg39QWoDNlz/OEGbfyTsrD1lwHrAhida5p4KOx2nJ7ob5h4//dFjnr9h4gzP8/ehZ9WwuQ8Ou+s1rUTD4Gm6Wb9hRRrGLmK/S1imYexB6f1mlWkYmrqqsmHkGdlHZ2KraBgZVeU13Bln8V46TMOX0KwK/x9e/Gea+OfS/I1FkYaTxLhNRQ3H09S8dvt9tLbh6JQb7v/c48feYw6ddo9/7Fy+6gIAAAAAAABcsj/9Uihp19PW+QAAAABJRU5ErkJggg==",button:""},on:{click:function(e){return t.defaultMap()}}}),t._v(" "),r("l-control-layers",{attrs:{position:t.layersPosition,collapsed:!1,"sort-layers":!0}}),t._v(" "),t._l(t.tileProviders,(function(e){return r("l-tile-layer",{key:e.name,attrs:{name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,token:t.token,"layer-type":"base"}})})),t._v(" "),r("l-control-zoom",{attrs:{position:t.zoomPosition}}),t._v(" "),r("l-control-attribution",{attrs:{position:t.attributionPosition,prefix:t.attributionPrefix}}),t._v(" "),r("l-control-scale",{attrs:{imperial:t.imperial}}),t._v(" "),t._l(t.markers,(function(e){return r("l-marker",{key:e.id,attrs:{visible:e.visible,draggable:e.draggable,"lat-lng":e.position},on:{"update:latLng":function(r){return t.$set(e,"position",r)},"update:lat-lng":function(r){return t.$set(e,"position",r)},click:function(r){return t.showOrder(e)}}},[r("l-icon",{attrs:{"icon-size":t.dynamicSize,"icon-anchor":t.dynamicAnchor,"icon-url":e.markerIcon}}),t._v(" "),r("l-popup",{attrs:{content:e.tooltip}}),t._v(" "),r("l-tooltip",{attrs:{content:e.tooltip}})],1)})),t._v(" "),t._l(t.markers,(function(t){return r("l-polyline",{key:t.travelId,attrs:{"lat-lngs":t.travel}})}))],2),t._v(" "),r("CSidebar",{style:t.sideStyle,attrs:{id:"my-side-order",aside:"",show:t.sideShow,colorScheme:"light",size:"lg"}},[r("span",{staticClass:"close-order",on:{click:function(e){return t.handleSideOrder()}}},[t._v("x")]),t._v(" "),r("CTabs",{staticClass:"nav-underline nav-underline-primary",attrs:{tabs:""}},[r("CTab",[r("template",{slot:"title"},[t._v("\n          "+t._s(t.$t("drivers"))+"\n        ")]),t._v(" "),r("CListGroup",{staticClass:"list-group-accent"},[r("CListGroupItem",{staticClass:"list-group-item-accent-secondary bg-light text-center\n          font-weight-bold text-muted text-uppercase small"},[t._v("\n             "+t._s(t.$t("online"))+"\n          ")]),t._v(" "),t._l(t.fleets,(function(e){return r("CListGroupItem",{key:e.user.id,staticClass:"list-group-item-accent-success list-group-item-divider",attrs:{href:"#"},on:{click:function(r){return t.focusOnDriver(e.lat,e.lng)}}},[r("div",{staticClass:"c-avatar float-right"},[r("img",{staticClass:"c-avatar-img",attrs:{src:"img/avatars/1.png",alt:"admin@bootstrapmaster.com"}})]),t._v(" "),r("div",[r("strong",[t._v(t._s(e.user.name))])]),t._v(" "),r("small",{staticClass:"text-muted mr-3"},[r("CIcon",{attrs:{name:"cil-list"}}),t._v("  "+t._s(e.user.orders_count)+"\n               "+t._s(t.$t("orders"))+"\n            ")],1),t._v(" "),r("small",{staticClass:"text-muted"},[r("CIcon",{attrs:{name:"cil-mobile"}}),t._v(" "+t._s(e.user.mobile)+"\n            ")],1)])})),t._v(" "),r("hr",{staticClass:"transparent mx-3 my-0"}),t._v(" "),r("CListGroupItem",{staticClass:"list-group-item-accent-secondary bg-light text-center\n          font-weight-bold text-muted text-uppercase small"},[t._v("\n             "+t._s(t.$t("offline"))+"\n          ")])],2)],2),t._v(" "),r("CTab",{attrs:{active:""}},[r("template",{slot:"title"},[t._v("\n           "+t._s(t.$t("orders"))+"\n        ")]),t._v(" "),t._l(t.orders,(function(e){return r("CListGroupItem",{key:e.id,staticClass:"list-group-item-accent-success list-group-item-divider",attrs:{href:"#"},on:{click:function(r){return t.focusOnDriver(e.pick_up_lat,e.delivery_lng)}}},[r("div",{staticClass:"c-avatar float-right"},[r("p",{class:" like-img bg-"+e.status.class},[t._v("\n              "+t._s(null!=e.customer_name?e.customer_name.substring(0,1):"")+"\n            ")]),t._v(" "),r("br"),t._v(" "),r("p",{staticClass:"my-customer-name"},[t._v("\n              "+t._s(e.customer_name)+"\n            ")])]),t._v(" "),r("div",{staticClass:"my-locale"},[r("span",{class:" my-p bg-"+e.status.class},[t._v("\n              "+t._s(null!=e.status?e.status.name.substring(0,1):"")+"\n            ")])]),t._v(" "),r("div",[r("strong",[r("span",{class:" the-code text-"+e.status.class},[t._v("Code:")]),t._v("\n              "+t._s(e.code))])]),t._v(" "),r("small",{staticClass:"text-muted mr-3"},[r("img",{staticClass:"my-money",attrs:{src:"https://www.vhv.rs/dpng/d/511-5119015_blue-money-icon-png-png-download-habitat-for.png",alt:""}}),t._v(" "),r("strong",[t._v(" "+t._s(e.total_price)+" SR ")])]),t._v(" "),r("small",{staticClass:"text-muted my-date-delivery"},[r("CIcon",{attrs:{name:"cil-mobile"}}),t._v(" "+t._s(e.delivery_time)+"\n          ")],1),t._v(" "),r("small",{staticClass:"te\n          xt-muted"},[r("CBadge",{staticClass:"my-status",attrs:{color:e.status.class}},[t._v("\n              "+t._s(e.status.name))])],1)])}))],2)],1)],1)],1)}),[],!1,null,null,null);e.default=O.exports}}]);