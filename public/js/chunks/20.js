(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{522:function(t,e,a){"use strict";a.r(e);var n=a(2),o=a.n(n),i={name:"Wallet",data:function(){return{items:[],fields:["amount","description","created_at","type"],sorter:{column:"",asc:!1},activePage:1,maxPages:1,message:"",alertColor:"",showMessage:!1,dismissSecs:3,dismissCountDown:0,showDismissibleAlert:!1,columnFilter:{},pageOfItems:[],loading:!1,balance:0,withdrawModal:!1,withdrawAmount:null,withdrawDescription:null}},watch:{activePage:function(){this.getWallet()},sorter:{handler:function(){this.getWallet()},deep:!0},columnFilter:function(){this.getWallet()}},methods:{changeItemsLimit:function(t){this.itemsLimit=t,this.getWallet()},getBadge:function(t){return"deposit"===t?"success":"withdraw"===t?"danger":"primary"},getWalletBadge:function(t){return parseFloat(t)<=0?"danger":"success"},withdraw:function(){var t=this;o.a.post("/api/fleet/wallet/withdraw/"+t.$route.params.id+"?token="+localStorage.getItem("api_token"),{amount:t.withdrawAmount,description:t.withdrawDescription}).then((function(e){t.alertColor="success",t.message="Successfully withdrew money.",t.showAlert(),t.withdrawModal=!1,t.getWallet()})).catch((function(e){console.log(e),t.alertColor="danger",t.message="unexpected error occurred in delete the fleet.",t.showAlert()}))},countDownChanged:function(t){this.dismissCountDown=t},showAlert:function(){this.dismissCountDown=this.dismissSecs},getWallet:function(){this.loading=!0;var t=this;this.items=[],o.a.get("/api/fleet/wallet/"+t.$route.params.id+"?page="+t.activePage+"&token="+localStorage.getItem("api_token"),{params:{sorter:t.sorter,columnFilter:t.columnFilter,itemsLimit:t.itemsLimit}}).then((function(e){console.log(e),t.items=t.items.concat(e.data.wallet.transactions.data),t.maxPages=e.data.wallet.transactions.last_page,t.balance=e.data.wallet.balance,t.loading=!1})).catch((function(e){console.log(e),t.loading=!1,t.alertColor="danger",t.message="unexpected error occurred in gettin fleets.",t.showAlert()}))},makeFilter:function(){this.getWallet()}},mounted:function(){this.getWallet()}},l=a(1),r=Object(l.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CRow",[a("CCol",{attrs:{col:"12",xl:"12"}},[a("transition",{attrs:{name:"slide"}},[a("CCard",[a("CCardHeader",[t._v("\n          Drivers\n        ")]),t._v(" "),a("CCardBody",[a("h4",[t._v("Total Balance "),a("CBadge",{attrs:{color:t.getWalletBadge(t.balance)}},[t._v(t._s(t.balance))])],1),t._v(" "),a("CButton",{staticClass:"m-3",attrs:{color:"primary"},on:{click:function(e){t.withdrawModal=!0}}},[t._v("Withdraw Money From this wallet")]),t._v(" "),a("CAlert",{attrs:{show:t.dismissCountDown,color:t.alertColor,fade:""},on:{"update:show":function(e){t.dismissCountDown=e}}},[t._v("\n            ("+t._s(t.dismissCountDown)+") "+t._s(t.message)+"\n          ")]),t._v(" "),a("CCol",{attrs:{sm:"12"}},[a("CDataTable",{attrs:{items:t.items,fields:t.fields,"index-column":"",hover:"","table-column":"","items-per-page-select":"",sorter:{external:!0,resetable:!0},columnFilter:{external:!0,lazy:!0},"sorter-value":t.sorter,"column-filter-value":t.columnFilter,loading:t.loading},on:{"pagination-change":t.changeItemsLimit,"update:sorterValue":function(e){t.sorter=e},"update:sorter-value":function(e){t.sorter=e},"update:columnFilterValue":function(e){t.columnFilter=e},"update:column-filter-value":function(e){t.columnFilter=e}},scopedSlots:t._u([{key:"description",fn:function(e){var n=e.item;return[null!==n.meta?a("td",[t._v("\n                  "+t._s(n.meta.description)+"\n                ")]):a("td")]}},{key:"amount",fn:function(e){var n=e.item;return[a("td",[a("CBadge",{attrs:{color:t.getWalletBadge(n.amount)}},[t._v(t._s(n.amount))])],1)]}},{key:"type",fn:function(e){var n=e.item;return[a("td",[a("CBadge",{attrs:{color:t.getBadge(n.type)}},[t._v(t._s(n.type))])],1)]}}])}),t._v(" "),a("CPagination",{attrs:{pages:t.maxPages,"active-page":t.activePage},on:{"update:activePage":function(e){t.activePage=e},"update:active-page":function(e){t.activePage=e}}})],1)],1)],1)],1)],1),t._v(" "),a("CModal",{attrs:{title:"Withdraw Fund From "+t.balance,show:t.withdrawModal},on:{"update:show":function(e){t.withdrawModal=e}}},[a("CInput",{attrs:{type:"text",label:"Amount",placeholder:"Amount"},model:{value:t.withdrawAmount,callback:function(e){t.withdrawAmount=e},expression:"withdrawAmount"}}),t._v(" "),a("CInput",{attrs:{type:"text",label:"Description",placeholder:"Description"},model:{value:t.withdrawDescription,callback:function(e){t.withdrawDescription=e},expression:"withdrawDescription"}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("CButton",{staticClass:"float-right",attrs:{color:"primary"},on:{click:function(e){return t.withdraw()}}},[t._v("\n        save\n      ")]),t._v(" "),a("CButton",{attrs:{color:"danger"},on:{click:function(e){t.withdrawModal=!1}}},[t._v("\n        Close\n      ")])],1)],1)],1)}),[],!1,null,null,null);e.default=r.exports}}]);